<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"      
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:cyk="http://primefaces.jsf.web.utility.cyk.org">
	
 	<p:dialog id="dialog" header="#{__page__.dialogTitle}" modal="true" widgetVar="dialog" fitViewport="true" 
		styleClass="cyk-administrative-unit-dialog" closeOnEscape="true" draggable="false" dynamic="true" resizable="false">
		
		<p:dataTable id="dialogDataTable" value="#{__page__.selectedAdministrativeUnits}" var="administrativeUnit" rowIndexVar="rowIndex">
  			<p:column headerText="#" width="40">
  				<h:outputText value="#{rowIndex+1}" />
  			</p:column>
  			<p:column headerText="Unité administrative" style="vertical-align: top;">
  				<ui:include src="../outputText_code_name.xhtml">
					<ui:param name="code" value="#{administrativeUnit.code}"/>
					<ui:param name="name" value="#{administrativeUnit.name}"/>
				</ui:include>
  			</p:column>
  			<p:column headerText="Gestionnaire de" style="vertical-align: top;">
  				<ui:repeat value="#{administrativeUnit.activities}" var="activity">
  					<ui:include src="../outputText_code_name.xhtml">
						<ui:param name="code" value="#{activity.code}"/>
						<ui:param name="name" value="#{activity.name}"/>
					</ui:include>
					<br/>
  				</ui:repeat>
  			</p:column>
  			<p:column headerText="Béneficiaire de" style="vertical-align: top;">
  				<ui:repeat value="#{administrativeUnit.activitiesBeneficiaire}" var="activity">
  					<ui:include src="../outputText_code_name.xhtml">
						<ui:param name="code" value="#{activity.code}"/>
						<ui:param name="name" value="#{activity.name}"/>
					</ui:include>
					<br/>
  				</ui:repeat>
  			</p:column>
  		</p:dataTable>
		<p:separator/>
		
		<ui:fragment rendered="#{__page__.dialogAction eq 'merge'}">
			<span>
				<p:outputLabel for="ua" value="Toutes les unités administratives ci dessus seront fusionnées en la suivante :" />
				<p:selectOneMenu id="ua" value="#{__page__.administrativeUnit}" converter="#{objectConverter}">
					<f:selectItems value="#{__page__.selectedAdministrativeUnits}" var="dua" itemValue="#{dua}" itemLabel="#{dua}" />
				</p:selectOneMenu>		
			</span>						
			<p:separator/>
		</ui:fragment>						
		
		<p:staticMessage severity="warn" summary="Avertissement" detail="#{__page__.dialogMessage}"/>
		<p:separator/>
		<div style="text-align: center;">
			<cyk:commandable value="#{__page__.dialogActionCommandable}" />
			<p:commandButton type="button" value="Non" onclick="PF('dialog').hide()"/>
		</div>
  	</p:dialog>
	
</ui:composition>